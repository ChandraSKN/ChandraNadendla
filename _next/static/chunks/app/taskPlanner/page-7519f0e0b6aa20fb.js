(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{309:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var d=t(5155),a=t(2115),n=t(5294),l=t(4211),i=t(7581),r=t(3306),o=t(7916);let c=(0,t(4982).UU)("https://rkowgbocbhrkagikzcpb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJrb3dnYm9jYmhya2FnaWt6Y3BiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwNzQ4ODMsImV4cCI6MjA2NTY1MDg4M30.I36ZsWTPBO2Ki25iX8ZJYTcVXsvWhPakp1eovPpDwvc");t(1687);let u={columns:{todo:{id:"todo",title:"To Do",taskIds:[]},"in-progress":{id:"in-progress",title:"In Progress",taskIds:[]},done:{id:"done",title:"Done",taskIds:[]}},tasks:{},columnOrder:["todo","in-progress","done"]};function x(){let[e,s]=(0,a.useState)(null),[t,x]=(0,a.useState)({}),[p,h]=(0,a.useState)({id:null,text:""}),[m,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{c.from("kanban_boards").select("data").order("inserted_at",{ascending:!1}).limit(1).single().then(e=>{let{data:t,error:d}=e;d||!t?s(u):s(t.data)})},[]),(0,a.useEffect)(()=>{e&&(g(!0),c.from("kanban_boards").insert([{data:e}]).then(()=>g(!1)))},[e]);let b=(0,a.useCallback)(t=>{if(!t.destination)return;let{source:d,destination:a,draggableId:n}=t;if(d.droppableId===a.droppableId&&d.index===a.index)return;let l=e.columns[d.droppableId],i=e.columns[a.droppableId];if(l===i){let e=Array.from(l.taskIds);e.splice(d.index,1),e.splice(a.index,0,n);let t={...l,taskIds:e};s(e=>({...e,columns:{...e.columns,[t.id]:t}}));return}let r=Array.from(l.taskIds);r.splice(d.index,1);let o={...l,taskIds:r},c=Array.from(i.taskIds);c.splice(a.index,0,n);let u={...i,taskIds:c};s(e=>({...e,columns:{...e.columns,[o.id]:o,[u.id]:u}}))},[e]),{nodes:k,edges:f}=(0,a.useMemo)(()=>{if(!e)return{nodes:[],edges:[]};let s=[],t=[];s.push({id:"root",data:{label:"Tasks"},position:{x:0,y:0},style:{background:"Brown",padding:8}});let d=360/e.columnOrder.length;return e.columnOrder.forEach((a,n)=>{let l=e.columns[a],i=Math.PI/180*(n*d),r=200*Math.cos(i),o=200*Math.sin(i);s.push({id:l.id,data:{label:l.title},position:{x:r,y:o},style:{background:"#bbdefb",padding:6}}),t.push({id:"e-root-".concat(l.id),source:"root",target:l.id}),l.taskIds.forEach((d,a)=>{let n=e.tasks[d],i=Math.PI/180*(a*(360/l.taskIds.length));s.push({id:n.id,data:{label:n.content},position:{x:r+80*Math.cos(i),y:o+80*Math.sin(i)},style:{background:"#c8e6c9",padding:4,width:120}}),t.push({id:"e-".concat(l.id,"-").concat(n.id),source:l.id,target:n.id})})}),{nodes:s,edges:t}},[e]);if(!e)return(0,d.jsx)("div",{className:"p-6",children:"Loading board…"});let I=e=>{let d=(t[e]||"").trim();if(!d)return;let a="task-".concat(Date.now());s(s=>({...s,tasks:{...s.tasks,[a]:{id:a,content:d}},columns:{...s.columns,[e]:{...s.columns[e],taskIds:[...s.columns[e].taskIds,a]}}})),x(s=>({...s,[e]:""}))},j=e=>h({id:e.id,text:e.content}),v=()=>{s(e=>({...e,tasks:{...e.tasks,[p.id]:{...e.tasks[p.id],content:p.text}}})),h({id:null,text:""})},N=e=>{s(s=>{let{[e]:t,...d}=s.tasks,a={};for(let t of Object.values(s.columns))a[t.id]={...t,taskIds:t.taskIds.filter(s=>s!==e)};return{...s,tasks:d,columns:a}})};return e?(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"p-6 space-y-8 bg-gray-50 min-h-screen",children:[(0,d.jsxs)("h1",{className:"text-2xl font-bold",children:["Kanban Board ",m&&(0,d.jsx)("span",{children:"⏳"})]}),(0,d.jsx)(n.JY,{onDragEnd:b,children:(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.columnOrder.map(s=>{let a=e.columns[s],l=a.taskIds.map(s=>e.tasks[s]);return(0,d.jsx)(n.gL,{droppableId:a.id,children:e=>(0,d.jsxs)("div",{ref:e.innerRef,...e.droppableProps,className:"bg-white rounded-lg shadow p-4 flex flex-col",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,d.jsx)("h2",{className:"text-lg font-semibold",children:a.title}),(0,d.jsx)("span",{className:"bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded text-sm",children:l.length})]}),(0,d.jsxs)("div",{className:"flex-1 space-y-2",children:[l.map((e,s)=>(0,d.jsx)(n.sx,{draggableId:e.id,index:s,children:s=>(0,d.jsx)("div",{ref:s.innerRef,...s.draggableProps,...s.dragHandleProps,className:"bg-gray-100 rounded p-2 relative hover:bg-gray-200 transition",children:p.id===e.id?(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("input",{className:"w-full border rounded p-1",value:p.text,onChange:e=>h(s=>({...s,text:e.target.value}))}),(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsx)("button",{onClick:v,className:"px-2 py-1 bg-green-600 text-white rounded text-sm",children:"Save"}),(0,d.jsx)("button",{onClick:()=>h({id:null,text:""}),className:"px-2 py-1 bg-gray-400 text-white rounded text-sm",children:"Cancel"})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("p",{children:e.content}),(0,d.jsxs)("div",{className:"absolute top-1 right-1 flex space-x-1",children:[(0,d.jsx)("button",{onClick:()=>j(e),className:"text-blue-600 text-xs hover:underline",children:"Edit"}),(0,d.jsx)("button",{onClick:()=>N(e.id),className:"text-red-600 text-xs hover:underline",children:"Delete"})]})]})})},e.id)),e.placeholder]}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("input",{type:"text",placeholder:"   Add new task",className:"w-full border px-2 py-1 rounded mb-2 text-sm",value:t[a.id]||"",onChange:e=>x(s=>({...s,[a.id]:e.target.value}))}),(0,d.jsx)("button",{onClick:()=>I(a.id),className:"w-full bg-indigo-600 text-white py-1 rounded text-sm hover:bg-indigo-700 transition",children:"Add"})]})]})},a.id)})})}),(0,d.jsx)("div",{className:"h-[400px]",children:(0,d.jsxs)(l.Gc,{nodes:k,edges:f,fitView:!0,nodesDraggable:!0,nodesConnectable:!0,children:[(0,d.jsx)(i.o,{}),(0,d.jsx)(r.H,{}),(0,d.jsx)(o.V,{gap:20,color:"#aaa"})]})})]})}):(0,d.jsx)("p",{children:"Loading board…"})}},8253:(e,s,t)=>{Promise.resolve().then(t.bind(t,309))}},e=>{var s=s=>e(e.s=s);e.O(0,[294,702,309,424,441,684,358],()=>s(8253)),_N_E=e.O()}]);